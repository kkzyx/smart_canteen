<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
				"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.holly.mapper.SetmealDishMapper">
	
	<!-- 根据菜品id查询关联的套餐 -->
	<select id="getSetmealDishByDishIds" resultType="java.lang.Long">
		select `setmeal_id`
		from `setmeal_dish`
		where `dish_id` in
		<foreach collection="dishIds" open="(" separator="," close=")" item="dishId">
			#{dishId}
		</foreach>
	</select>
	
	<!-- 批量保存套餐和菜品的关联关系 -->
	<insert id="insertBatch" parameterType="list">
		insert into `setmeal_dish` (`setmeal_id`, `dish_id`, `name`, `price`, `copies`, `image`)
		values
		<foreach collection="setmealDishesList" item="sd" separator=",">
			(#{sd.setmealId},#{sd.dishId},#{sd.name},#{sd.price},#{sd.copies}, #{sd.image})
		</foreach>
	</insert>
	
	<!-- 根据套餐ids集合批量删除套餐和菜品的关联关系 -->
	<delete id="deleteBySetmealIds">
		delete from `setmeal_dish` where `setmeal_id` in
		<foreach collection="setmealIds" item="setmealId" open="(" separator="," close=")">
			#{setmealId}
		</foreach>
	</delete>
</mapper>
