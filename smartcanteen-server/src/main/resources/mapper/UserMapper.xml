<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
				"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.holly.mapper.UserMapper">
	
	<!-- 新增微信用户 -->
	<insert id="insert" useGeneratedKeys="true" keyProperty="id">
		insert into `user` (`openid`, `name`, `phone`, `sex`, `avatar`, `create_time`)
		values (#{openid}, #{name}, #{phone}, #{sex}, #{avatar}, #{createTime})
	</insert>
	
	<!-- 更新微信用户信息 -->
	<update id="update">
		update `user`
		<set>
			<if test="name!= null">`name` = #{name},</if>
		  <if test="phone!= null">`phone` = #{phone},</if>
			<if test="sex!= null">`sex` = #{sex},</if>
		  <if test="avatar!= null">`avatar` = #{avatar},</if>
		</set>
		where `id` = #{id}
	</update>
	
	<!-- 根据条件查询用户数量 -->
	<select id="countByMap" resultType="java.lang.Integer">
		select count(`id`) from `user`
		<where>
			<if test="begin != null">
				and `create_time` &gt; #{begin}
			</if>
			<if test="end != null">
				and `create_time` &lt; #{end}
			</if>
		</where>
	</select>
	
	<!-- 根据日期条件查询指定范围内用户列表 -->
	<select id="findUsersByMap" resultType="com.holly.entity.User">
		select * from `user`
		<where>
			<if test="begin != null">
				and `create_time` &gt;= #{begin}
			</if>
			<if test="end != null">
				and `create_time` &lt;= #{end}
			</if>
		</where>
	</select>
</mapper>